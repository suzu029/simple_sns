{% extends "base.html" %}

{% block content %}
  <h2>投稿一覧</h2>

  <!-- 新しい投稿ボタン -->
  <p>
    <a href="{% url 'post_create' %}" style="text-decoration:none;">
      📝 投稿
    </a>
  </p>

  {% for post in posts %}
    <div>
      <p><strong>{{ post.user.username }}</strong></p>
      <p>{{ post.content }}</p>
      {% if post.image %}
        <img src="{{ post.image.url }}" width="300">
      {% endif %}
      <p>❤️ {{ post.total_likes }} いいね</p>

      <form action="{% url 'like_post' post.id %}" method="post">
        {% csrf_token %}
        {% if user in post.likes.all %}
          <button type="submit">いいね解除</button>
        {% else %}
          <button type="submit">いいね</button>
        {% endif %}
      </form>
      <hr>
    </div>
  {% endfor %}
{% endblock %}
